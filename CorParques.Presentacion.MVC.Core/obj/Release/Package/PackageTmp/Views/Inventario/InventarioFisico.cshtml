@model IEnumerable<CorParques.Negocio.Entidades.Materiales>

@{
    ViewBag.Title = "Inventario físico";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var ListMotivos = (IEnumerable<CorParques.Negocio.Entidades.MotivosInventario>)ViewBag.Motivos;
}
<link href="~/Vendors/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet" />
<link href="~/Vendors/datatables.net-responsive-bs/css/responsive.bootstrap.min.css" rel="stylesheet">
<link href="~/Vendors/datatables.net-scroller-bs/css/scroller.bootstrap.min.css" rel="stylesheet">
<link href="~/Content/jquery-ui.min.css" rel="stylesheet" />

<form id="frmInventarioFisico">
    @if (Model != null)
    {
        <div class="dataTables_wrapper form-inline dt-bootstrap no-footer">
            <div id="datatable-responsive_filter" class="dataTables_filter">
                <label>Buscar:<input type="search" id="txtSearch" class="form-control input-sm" placeholder="" aria-controls="datatable-responsive"></label>
            </div>
        </div>


        <table class="table table-striped  table-bordered" id="tbInventarioFisico" width="100%">
            <thead>
                <tr>

                    @*CÓDIGO SAP*@
                    <th>Código Sap</th>

                    @*NOMBRE MATERIAL*@
                    <th>Material</th>

                    <!--INVENTARIO TEÓRICO-->
                    <th style="display:none">Inv. teórico</th> 
                    
                    @*UNIDAD*@
                    <th>Unid.</th>

                    @*INVENTARIO FÍSICO*@
                    <th width="60px">Inv. físico</th>

                    @*DIFERENCIA*@
                    <th style="display:none">Dif.</th> 
                    
                    @*TIPO MOVIMIENTO*@
                    <th style="display:none">Tipo Mov</th>
                    
                    @*MOTIVO*@
                    <th style="display:none" width="50px">Motivo</th>

                    @*OBSERVACIONES*@
                    <th width="120px">Observaciones</th>

                    @*COSTO PROMEDIO*@
                    <th style="display:none">Costo promedio</th> -->
                    
                </tr>
            </thead>
            <tbody>

                @{int contador = 0;}
                @foreach (var item in Model)
                {
                    <tr>

                        <!--0-->
                        <input type="hidden" name="CodSapMaterial" value="@item.CodigoSap" />   
                        <!--1-->
                        <input type="hidden" name="UnidadMedida" value="@item.Unidad" /> 
                        <!--2-->
                        <input type="hidden" id="CodSapAjuste_@contador" name="CodSapTipoAjuste" value="@item.CodSapAjuste" /> 
                        <!--3-->
                        <input type="hidden" name="[@contador].IdUsuarioAjuste" class="IdSupervisor" /> 
                        <!--4-->
                        <input type="hidden" id="Cantidad_@contador" name="Cantidad" value="@item.Cantidad" />  
                        <!--5-->
                        <input type="hidden" id="Costohidden_@contador" name="Costo" value="@item.CostoPromedio" /> 

                       

                        @*CÓDIGO SAP*@
                        <!--6-->
                        <td>@item.CodigoSap</td>

                        @*NOMBRE MATERIAL*@
                        <!--7-->
                        <td value="">@item.Nombre</td>

                        <!--INVENTARIO TEÓRICO-->
                        <!--8-->
                        <td style="display:none">@item.CantidadDisponible</td>

                        @*UNIDAD*@
                        <!--9-->
                        <td>@item.Unidad</td>

                        @*INVENTARIO FÍSICO FUNCIONAL*@
                        <!--10-->
                        <td><input type="text" id="CantidadDisponible" data-id="@item.CantidadDisponible" class="decimal datoInput required" style="width:60px" data-contador="@contador" value="" onkeyup="DiferenciaInventarioFisico(this);" /></td>

                        @*DIFERENCIA*@
                        <!--11-->
                        <td style="display:none"><div id="Diferencia_@contador" class="Valor" data-id="@contador" value=""> </div></td>

                        @*TIPO MOVIMIENTO*@
                        <!--12-->
                        <td style="display:none"><div id="Movimiento_@contador" class="Valor" data-id="@contador"> </div></td>

                        @*MOTIVO*@
                        <!--13-->
                        <td style="display:none"><!--@Html.DropDownListFor(model => @item.CodSapMotivo, new SelectList(ViewBag.Motivos, "CodSapMotivo", "Descripcion", ViewBag.Motivos), "Seleccione...", new { @class = "btn", Style = "width:70px", @Name = $"CodSapMotivo", @Id = $"CodSapMotivo_{contador}"}) -->1</td>

                        @*OBSERVACIONES*@
                        <!--14-->
                        <td>@Html.TextAreaFor(model => @item.Observaciones, new { rows = "1", @class = "col-md-12", maxlength = 500, Style = "width:100px", @Name = $"Observaciones", @Id = $"Observaciones_{contador}", @value = "" })</td>

                        @*COSTO PROMEDIO*@
                        <!--15-->
                        <td style="display:none"><div id="Costo_@contador" class="Valor" data-id="@contador"> </div></td>
                    </tr>
                    contador++;
                }
            </tbody>
        </table>

        <br />
        <div class="row " style="text-align:right">
            <div class="item col-md-12 col-sm-12 col-xs-12">
                <a href="javascript:void(0)" id="btnSaveInventario" class="right btn btn-success">Guardar</a>
                <a href="javascript:void(0)" id="btnCancelInventario" class="right btn btn-danger">Cancelar</a>
            </div>
        </div>

        if (ViewBag.Motivos != null)
        {
            <script>
                 var listaMotivos = @Html.Raw(Json.Encode(ViewBag.Motivos));
            </script>
        }



        @section scripts{
            <script src="~/Vendors/datatables.net/js/jquery.dataTables.min.js"></script>
            <script src="~/Vendors/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
            <script src="~/Vendors/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
            <script src="~/Vendors/datatables.net-responsive-bs/js/responsive.bootstrap.js"></script>
            <script src="~/Vendors/datatables.net-scroller/js/dataTables.scroller.min.js"></script>
            <script src="~/Scripts/jquery-ui.min.js"></script>
            <script src="~/Scripts/jquery-ui.min.autComp.js"></script>
            <script src="~/Vendors/jQuery-Mask-Plugin-master/dist/jquery.mask.min.js"></script>
            <script src="~/Scripts/select2.min.js"></script>
            <script src="~/Scripts/Inventario.js"></script>
            <script>
                $(function () {

                });
            </script>
        }

    }
</form>
